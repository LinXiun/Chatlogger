local Players = game:GetService("Players")
local Chat = game:GetService("Chat")
local player = Players.LocalPlayer

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ChatLoggerGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Create ScrollingFrame
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(0, 400, 0, 300)
scrollFrame.Position = UDim2.new(0, 10, 0, 10)
scrollFrame.BackgroundTransparency = 1
scrollFrame.BorderSizePixel = 0
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.ScrollBarThickness = 4
scrollFrame.Parent = screenGui

-- Layout to stack messages vertically
local layout = Instance.new("UIListLayout")
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0, 4)
layout.Parent = scrollFrame

-- Function to log chat messages
local function logMessage(messageText, fromSpeaker)
	local messageLabel = Instance.new("TextLabel")
	messageLabel.Size = UDim2.new(1, -10, 0, 20)
	messageLabel.BackgroundTransparency = 1
	messageLabel.TextColor3 = Color3.new(1, 1, 1)
	messageLabel.Font = Enum.Font.SourceSans
	messageLabel.TextSize = 18
	messageLabel.TextWrapped = true
	messageLabel.Text = fromSpeaker .. ": " .. messageText
	messageLabel.Parent = scrollFrame

	-- Update canvas size
	scrollFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y)
end

-- Listen to filtered chat messages
Chat.OnMessageDoneFiltering.OnClientEvent:Connect(function(messageData)
	if messageData and messageData.Message and messageData.FromSpeaker then
		logMessage(messageData.Message, messageData.FromSpeaker)
	end
end)