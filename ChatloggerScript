-- Chat logger with unique username colors, clickable spectate, UTC+8 timestamps, and Return to Me button
local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- GUI setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ChatLoggerGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- [GUI creation code remains unchanged...]

-- Log messages with clickable username button
local function logMessage(text, authorName)
	local entry = Instance.new("Frame")
	entry.Size = UDim2.new(1, -10, 0, 0)
	entry.BackgroundTransparency = 1
	entry.BorderSizePixel = 0
	entry.LayoutOrder = layout.AbsoluteContentSize.Y + 1
	entry.AutomaticSize = Enum.AutomaticSize.Y
	entry.Parent = scrollFrame

	local pad = Instance.new("UIPadding", entry)
	pad.PaddingLeft = UDim.new(0, 6)
	pad.PaddingRight = UDim.new(0, 6)
	pad.PaddingTop = UDim.new(0, 2)
	pad.PaddingBottom = UDim.new(0, 2)

	local tsLabel = Instance.new("TextLabel", entry)
	tsLabel.Size = UDim2.new(0, 64, 0, 18)
	tsLabel.BackgroundTransparency = 1
	tsLabel.Font = Enum.Font.Code
	tsLabel.TextSize = 14
	tsLabel.Text = formatTimestampUTCplus8()
	tsLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
	tsLabel.TextXAlignment = Enum.TextXAlignment.Left
	tsLabel.TextYAlignment = Enum.TextYAlignment.Center

	local nameBtn = Instance.new("TextButton", entry)
	nameBtn.Size = UDim2.new(0, 120, 0, 0)
	nameBtn.Position = UDim2.new(0, 70, 0, 0)
	nameBtn.BackgroundTransparency = 1
	nameBtn.AutoButtonColor = false
	nameBtn.Font = Enum.Font.SourceSansBold
	nameBtn.TextSize = 18
	nameBtn.Text = authorName
	nameBtn.TextXAlignment = Enum.TextXAlignment.Left
	local unameColor = getColorForName(authorName)
	nameBtn.TextColor3 = unameColor
	nameBtn.AutomaticSize = Enum.AutomaticSize.Y

	nameBtn.MouseButton1Click:Connect(function()
		spectatePlayer(authorName)
	end)

	local msgLabel = Instance.new("TextLabel", entry)
	msgLabel.Size = UDim2.new(1, -200, 0, 0)
	msgLabel.Position = UDim2.new(0, 200, 0, 0)
	msgLabel.BackgroundTransparency = 1
	msgLabel.Font = Enum.Font.SourceSans
	msgLabel.TextSize = 18
	msgLabel.TextWrapped = true
	msgLabel.TextXAlignment = Enum.TextXAlignment.Left
	msgLabel.TextYAlignment = Enum.TextYAlignment.Top
	msgLabel.AutomaticSize = Enum.AutomaticSize.Y
	msgLabel.Text = text
	msgLabel.TextColor3 = Color3.fromRGB(220, 220, 220)

	local sep = Instance.new("Frame", entry)
	sep.Size = UDim2.new(1, 0, 0, 1)
	sep.Position = UDim2.new(0, 0, 1, -2)
	sep.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
	sep.BorderSizePixel = 0

	task.defer(function()
		scrollFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 8)
		scrollFrame.CanvasPosition = Vector2.new(0, math.max(0, layout.AbsoluteContentSize.Y - scrollFrame.AbsoluteSize.Y))
	end)
end

-- âœ… Updated to use DisplayName
TextChatService.OnIncomingMessage = function(message)
	if message.Text and message.TextSource then
		local author = tostring(message.TextSource.Name)
		if message.TextSource and message.TextSource.UserId then
			local p = Players:GetPlayerByUserId(message.TextSource.UserId)
			if p then
				author = p.DisplayName
			end
		end
		logMessage(message.Text, author)
	end
end

-- [Rest of the script remains unchanged...]